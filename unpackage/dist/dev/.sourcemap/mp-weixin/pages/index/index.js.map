{"version":3,"sources":["webpack:////Users/peng/Desktop/HX/SteyIoT/main.js","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue?74d5","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue?4e3c","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue?4d02","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue?8c02","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue?e344","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue?807c","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue?c6c3","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue?342c","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue?0bb2","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue?8439","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue?bd46","webpack:////Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue?4aef"],"names":["createPage","Page","data","statusBarHeight","navigationBarHeight","bottomArea","loginTip","gridColumn","roomNameValues","currentRoomValue","roomZones","isWebSocketOpen","isRequestSpacesDone","currentDeviceDataModel","showPop","deviceType","isDimmer","isCurtain","isAirConditioner","isAirPurification","components","DeviceItem","DeviceDimmerSetting","DeviceCurtainSetting","DeviceAirConditionerSetting","DeviceAirPurifierSetting","onLoad","getApp","globalData","uni","$on","requestAccessibleSpaces","isLogin","console","log","onSocketOpen","token","getStorageSync","Date","now","sendSocketMessage","JSON","stringify","onSocketError","onSocketMessage","res","handleSocketMeesage","onSocketClose","code","connectSocket","onShow","onHide","closeSocket","computed","popDeviceImage","device","typeC","switchImage","isDeviceOn","deviceName","switchState","methods","loginButtonClick","navigateTo","url","bookingButtonClick","encodeURIComponent","tapCurrentRoom","event","detail","requestIoTTemplate","request","method","header","success","statusCode","handleAccessibleSpaces","logout","error","showToast","icon","title","duration","fail","complete","spaces","map","obj","SpaceModel","length","spaceId","space","text","roomName","value","showLoading","mask","handleTemplate","zones","hideLoading","zone","RoomZoneModel","filter","item","isSystemZone","parse","socketModel","SocketModel","forEach","deviceDataModel","deviceDataModels","zoneDeviceId","deviceModel","controlModel","controls","control","zoneDeviceControlId","setDevice","deviceSettingClick","switchButtonClick","controlId","deviceControlModel","version","socketObj","sendSocket","then","popUpClose","sendSocketObj","Promise","resolve","reject","vibrateShort","timestamp","tag","DeviceControlModel","sliderValue","isDrag","isWatchDataChange","props","watch","newValue","oldValue","mounted","sliderValueChange","sliderDragEnd","sliderDragStart","$emit"],"mappings":"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","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=483fb224&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Users/peng/Desktop/HX/SteyIoT/pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=483fb224&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState, mapMutations } from 'vuex'\nimport SpaceModel from './js/space-model.js'\nimport RoomZoneModel from './js/room-zone.js'\nimport SocketModel from './js/socket-model.js'\nimport DeviceItem from './components/device-item.vue'\nimport DeviceDimmerSetting from './components/device-dimmer-setting.vue'\nimport DeviceCurtainSetting from './components/device-curtain-setting.vue'\nimport DeviceAirConditionerSetting from './components/device-air-conditioner-setting.vue'\nimport DeviceAirPurifierSetting from './components/device-air-purifier-setting.vue'\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tstatusBarHeight: 20,\n\t\t\tnavigationBarHeight: 64,\n\t\t\tbottomArea: 6,\n\t\t\tloginTip: '当前未登录',\n\t\t\tgridColumn: 2,\n\t\t\troomNameValues: [],\n\t\t\tcurrentRoomValue: null,\n\t\t\troomZones: [],\n\t\t\tisWebSocketOpen: false,\n\t\t\tisRequestSpacesDone: false,\n\t\t\tcurrentDeviceDataModel: null,\n\t\t\tshowPop: false,\n\t\t\tdeviceType: {\n\t\t\t\tisDimmer: false,\n\t\t\t\tisCurtain: false,\n\t\t\t\tisAirConditioner: false,\n\t\t\t\tisAirPurification: false\n\t\t\t}\n\t\t}\n\t},\n\tcomponents: {\n\t\tDeviceItem,\n\t\tDeviceDimmerSetting,\n\t\tDeviceCurtainSetting,\n\t\tDeviceAirConditionerSetting,\n\t\tDeviceAirPurifierSetting\n\t},\n\tonLoad() {\n\t\t// 计算\n\t\tthis.statusBarHeight = getApp().globalData.statusBarHeight\n\t\tthis.navigationBarHeight = getApp().globalData.navigationBarHeight\n\t\tthis.bottomArea = getApp().globalData.bottomArea > 0 ? getApp().globalData.bottomArea : 6\n\t\t// 接收全局登录事件\n\t\tuni.$on('haveLogin', () => {\n\t\t\tthis.requestAccessibleSpaces()\n\t\t})\n\t\t// 获取房间\n\t\tif (this.isLogin) {\n\t\t\tconsole.log(this.isLogin);\n\t\t\tthis.requestAccessibleSpaces()\n\t\t}\n\t\t// websocket 回调\n\t\tuni.onSocketOpen(() => {\n\t\t\tthis.isWebSocketOpen = true\n\t\t\tconsole.log('WebSocket连接已打开！');\n\t\t\t// 向服务器发送token\n\t\t\tlet data = {\n\t\t\t\t'data': {\n\t\t\t\t\ttoken: uni.getStorageSync('token')\n\t\t\t\t},\n\t\t\t\t'timestamp': Date.now()\n\t\t\t}\n\t\t\tuni.sendSocketMessage({\n\t\t\t\tdata: JSON.stringify(data)\n\t\t\t})\n\t\t})\n\t\tuni.onSocketError(function(){\n\t\t\tconsole.log('WebSocket连接打开失败！');\n\t\t})\n\t\tuni.onSocketMessage((res) => {\n\t\t\tthis.handleSocketMeesage(res.data)\n\t\t})\n\t\tuni.onSocketClose((res) => {\n\t\t\tthis.isWebSocketOpen = false\n\t\t  console.log('WebSocket 已关闭！', res);\n\t\t\tif (res.code === 1006) {\n\t\t\t\t// 自动断 重新连\n\t\t\t\tthis.connectSocket()\n\t\t\t}\n\t\t})\n\t},\n\tonShow() {\n\t\tif (this.isLogin && this.currentRoomValue) {\n\t\t\tthis.connectSocket()\n\t\t}\n\t},\n\tonHide() {\n\t\tuni.closeSocket()\n\t},\n\tcomputed: {\n\t\t...mapState(['isLogin']),\n\t\tpopDeviceImage() {\n\t\t\tif (this.currentDeviceDataModel) {\n\t\t\t\tswitch (this.currentDeviceDataModel.device.typeC) {\n\t\t\t\t\tcase 'dimmingcontrol':\n\t\t\t\t\treturn '../../static/images/stey_ioticon_editceilinglamp.png'\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'curtaincontrol':\n\t\t\t\t\treturn '../../static/images/stey_ioticon_editcurtain.png'\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'airconditionercontrol':\n\t\t\t\t\treturn '../../static/images/stey_ioticon_editairconditioner.png'\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'airpurifiercontrol':\n\t\t\t\t\treturn '../../static/images/stey_ioticon_editairquality.png'\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} \n\t\t\treturn ''\n\t\t},\n\t\tswitchImage() {\n\t\t\tif (this.currentDeviceDataModel) {\n\t\t\t\treturn this.currentDeviceDataModel.isDeviceOn ? '../../static/images/stey_ioticon_switch_on.png' : '../../static/images/stey_ioticon_switch_off.png'\n\t\t\t}\n\t\t\treturn ''\n\t\t},\n\t\tdeviceName() {\n\t\t\tif (this.currentDeviceDataModel) {\n\t\t\t\treturn this.currentDeviceDataModel.device.deviceName\n\t\t\t}\n\t\t\treturn ''\n\t\t},\n\t\tswitchState() {\n\t\t\tif (this.currentDeviceDataModel) {\n\t\t\t\treturn this.currentDeviceDataModel.isDeviceOn ? '已打开' : '已关闭'\n\t\t\t}\n\t\t\treturn ''\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapMutations(['logout']),\n\t\tloginButtonClick() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl:'../login/login'\n\t\t\t})\n\t\t},\n\t\tbookingButtonClick() {\n\t\t\tconst url = encodeURIComponent('https://www.stey.com/zh-CN/booking/list')\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `../web/web-view?url=${url}`\n\t\t\t})\n\t\t},\n\t\ttapCurrentRoom(event) {\n\t\t\tthis.currentRoomValue = event.detail\n\t\t\tthis.requestIoTTemplate()\n\t\t},\n\t\trequestAccessibleSpaces() {\n\t\t\t// 请求spaces信息\n\t\t\tuni.request({\n\t\t\t\turl: 'https://gateway.stey.com/iot-service/app/iot/accessible-spaces',\n\t\t\t\tmethod: 'GET',\n\t\t\t\tdata: {},\n\t\t\t\theader: {\n\t\t\t\t\t'Content-Type': 'application/json; charset=utf-8',\n\t\t\t\t\t'Authorization': `Bearer ${uni.getStorageSync('token')}`,\n\t\t\t\t\t'Accept-Language': 'zh'\n\t\t\t\t},\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\tthis.handleAccessibleSpaces(res.data.data)\n\t\t\t\t\t} else if (res.statusCode == 401) {\n\t\t\t\t\t\tconsole.log('token失效')\n\t\t\t\t\t\tthis.logout()\n\t\t\t\t\t\tthis.loginTip = '登录失效'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst error = res.data.error\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\ttitle: error,\n\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfail: () => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.isRequestSpacesDone = true\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\thandleAccessibleSpaces(data) {\n\t\t\tconst spaces = data.map((obj) => new SpaceModel(obj))\n\t\t\tif (spaces.length > 0) {\n\t\t\t\tthis.currentRoomValue = spaces[0].spaceId\n\t\t\t\tthis.roomNameValues = spaces.map((space) => {\n\t\t\t\t\tconst obj = {text: space.roomName, value: space.spaceId}\n\t\t\t\t\treturn obj\n\t\t\t\t})\n\t\t\t\tthis.requestIoTTemplate()\n\t\t\t} else {\n\t\t\t\tthis.currentRoomValue = 138\n\t\t\t\tthis.roomNameValues = [\n\t\t\t\t\t{text: '520', value: 138},\n\t\t\t\t\t{text: '521', value: 142}\n\t\t\t\t]\n\t\t\t\tthis.requestIoTTemplate()\n\t\t\t}\n\t\t},\n\t\trequestIoTTemplate() {\n\t\t\tif (this.currentRoomValue) {\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle:'',\n\t\t\t\t\tmask: true\n\t\t\t\t})\n\t\t\t\tuni.request({\n\t\t\t\t\turl: `https://gateway.stey.com/iot-service/staff-app/iot/template/${this.currentRoomValue}`,\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\tdata: {},\n\t\t\t\t\theader: {\n\t\t\t\t\t\t'Content-Type': 'application/json; charset=utf-8',\n\t\t\t\t\t\t'Authorization': `Bearer ${uni.getStorageSync('token')}`,\n\t\t\t\t\t\t'Accept-Language': 'zh'\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\t\tthis.handleTemplate(res.data.data.zones)\n\t\t\t\t\t\t} else if (res.statusCode == 401) {\n\t\t\t\t\t\t\tconsole.log('token失效')\n\t\t\t\t\t\t\tthis.logout()\n\t\t\t\t\t\t\tthis.loginTip = '登录失效'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst error = res.data.error\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\t\ttitle: error,\n\t\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\thandleTemplate(zones) {\n\t\t\t// 筛选非系统的zone\n\t\t\tconst roomZones = zones.map((zone) => new RoomZoneModel(zone)).filter((item) => !item.isSystemZone)\n\t\t\tthis.roomZones = roomZones\n\t\t\t//打开websocket\n\t\t\tthis.connectSocket()\n\t\t},\n\t\tconnectSocket() {\n\t\t\tif (this.isWebSocketOpen) {\n\t\t\t\tuni.closeSocket()\n\t\t\t}\n\t\t\tuni.connectSocket({\n\t\t\t\turl: `wss://gateway.stey.com/iot-service/app/iot/connect/${this.currentRoomValue}`,\n\t\t\t})\n\t\t},\n\t\thandleSocketMeesage(data) {\n\t\t\tconst obj = JSON.parse(data)\n\t\t\tconst socketModel = new SocketModel(obj)\n\t\t\tthis.roomZones.forEach((zone) => {\n\t\t\t\tconst deviceDataModel = zone.deviceDataModels.filter((deviceDataModel) => deviceDataModel.device.zoneDeviceId === socketModel.zoneDeviceId)[0]\n\t\t\t\tif (deviceDataModel) {\n\t\t\t\t\tconst deviceModel = deviceDataModel.device\n\t\t\t\t\tconst controlModel = deviceModel.controls.filter((control) => control.zoneDeviceControlId === socketModel.zoneDeviceControlId)[0]\n\t\t\t\t\tif (controlModel) {\n\t\t\t\t\t\tcontrolModel.value = socketModel.value\n\t\t\t\t\t\tdeviceDataModel.setDevice(deviceModel)\n\t\t\t\t\t\tif (this.currentDeviceDataModel && this.currentDeviceDataModel.device.zoneDeviceId === deviceModel.zoneDeviceId) {\n\t\t\t\t\t\t\tthis.currentDeviceDataModel = deviceDataModel\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log(socketModel);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tdeviceSettingClick(deviceDataModel) {\n\t\t\tthis.currentDeviceDataModel = deviceDataModel\n\t\t\tthis.deviceType.isDimmer = (deviceDataModel.device.typeC === 'dimmingcontrol')\n\t\t\tthis.deviceType.isCurtain = (deviceDataModel.device.typeC === 'curtaincontrol')\n\t\t\tthis.deviceType.isAirConditioner = (deviceDataModel.device.typeC === 'airconditionercontrol')\n\t\t\tthis.deviceType.isAirPurification = (deviceDataModel.device.typeC === 'airpurifiercontrol')\n\t\t\tthis.showPop = true\n\t\t},\n\t\tswitchButtonClick() {\n\t\t\tlet controlId = this.deviceControlModel(10).zoneDeviceControlId\n\t\t\tif (this.currentDeviceDataModel.device.typeC === 'airpurifiercontrol' && this.currentDeviceDataModel.device.version === 1) {\n\t\t\t\tcontrolId = this.deviceControlModel(40).zoneDeviceControlId\t\n\t\t\t}\n\t\t\tlet socketObj = {\n\t\t\t\t'spaceId': this.currentRoomValue,\n\t\t\t\t'value': this.currentDeviceDataModel.isDeviceOn ? 'false' : 'true',\n\t\t\t\t'zoneDeviceId': this.currentDeviceDataModel.device.zoneDeviceId,\n\t\t\t\t'zoneDeviceControlId': controlId,\n\t\t\t}\n\t\t\tthis.sendSocket(socketObj).then((res) => {\n\t\t\t\tthis.currentDeviceDataModel.isDeviceOn = !this.currentDeviceDataModel.isDeviceOn\n\t\t\t})\n\t\t},\n\t\tpopUpClose() {\n\t\t\tthis.showPop = false\n\t\t},\n\t\tsendSocketObj(obj) {\n\t\t\tlet socketObj = {\n\t\t\t\t'spaceId': this.currentRoomValue,\n\t\t\t\t...obj\n\t\t\t}\n\t\t\tthis.sendSocket(socketObj)\n\t\t},\n\t\tsendSocket(socketObj) {\n\t\t\tconsole.log(socketObj);\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t// 震动\n\t\t\t\tuni.vibrateShort()\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '发送中',\n\t\t\t\t\tmask: true\n\t\t\t\t})\n\t\t\t\tuni.request({\n\t\t\t\t\turl: 'https://gateway.stey.com/iot-service/staff-app/iot/run-command',\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdata: socketObj,\n\t\t\t\t\t\ttimestamp: Date.now()\n\t\t\t\t\t},\n\t\t\t\t\theader: {\n\t\t\t\t\t\t'Content-Type': 'application/json; charset=utf-8',\n\t\t\t\t\t\t'Authorization': `Bearer ${uni.getStorageSync('token')}`,\n\t\t\t\t\t\t'Accept-Language': 'zh'\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\t\tresolve(res)\n\t\t\t\t\t\t} else if (res.statusCode == 401) {\n\t\t\t\t\t\t\tconsole.log('token失效')\n\t\t\t\t\t\t\tthis.logout()\n\t\t\t\t\t\t\tthis.loginTip = '登录失效'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst error = res.data.error\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\t\ttitle: error,\n\t\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t},\n\t\tdeviceControlModel(tag) {\n\t\t\tconst controlModel = this.currentDeviceDataModel.device.controls.filter((control) => control.tag == tag)[0]\n\t\t\tif (controlModel) {\n\t\t\t\treturn controlModel\n\t\t\t}\n\t\t\treturn new DeviceControlModel()\n\t\t}\n\t}\n}\n","import { render, staticRenderFns, recyclableRender, components } from \"./device-dimmer-setting.vue?vue&type=template&id=191eeb11&\"\nvar renderjs\nimport script from \"./device-dimmer-setting.vue?vue&type=script&lang=js&\"\nexport * from \"./device-dimmer-setting.vue?vue&type=script&lang=js&\"\nimport style0 from \"./device-dimmer-setting.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Users/peng/Desktop/HX/SteyIoT/pages/index/components/device-dimmer-setting.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./device-dimmer-setting.vue?vue&type=template&id=191eeb11&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./device-dimmer-setting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./device-dimmer-setting.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport DeviceModel from '../js/device-model.js'\nimport DeviceDataModel from '../js/device-data-model.js';\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tsliderValue: 0,\n\t\t\tisDrag: false,\n\t\t\tisWatchDataChange: false\n\t\t}\n\t},\n\tprops: {\n\t\tdeviceDataModel: null\n\t},\n\twatch: {\n\t\tdeviceDataModel: function(newValue, oldValue) {\n\t\t\tthis.isWatchDataChange = true\n\t\t\tthis.sliderValue = newValue.sliderValue\n\t\t}\n\t},\n\tmounted() {\n\t\tif (this.deviceDataModel) {\n\t\t\tthis.sliderValue = this.deviceDataModel.sliderValue\n\t\t}\n\t},\n\tmethods: {\n\t\tsliderValueChange(event) {\n\t\t\tthis.sliderValue = event.detail\n\t\t\tif (!this.isDrag && !this.isWatchDataChange) {\n\t\t\t\tthis.sliderDragEnd()\n\t\t\t}\n\t\t},\n\t\tsliderDragStart() {\n\t\t\tthis.isDrag = true\n\t\t},\n\t\tsliderDragEnd() {\n\t\t\tthis.isDrag = false\n\t\t\tthis.isWatchDataChange = false\n\t\t\tif (!this.deviceDataModel.isDeviceOn) return\n\t\t\tlet controlId = this.deviceControlModel(20).zoneDeviceControlId\n\t\t\tconst obj = {\n\t\t\t\t'value': `${this.sliderValue}`,\n\t\t\t\t'zoneDeviceId': this.deviceDataModel.device.zoneDeviceId,\n\t\t\t\t'zoneDeviceControlId': controlId,\n\t\t\t}\n\t\t\tthis.$emit('sendsocketobj', obj)\n\t\t},\n\t\tdeviceControlModel(tag) {\n\t\t\tconst controlModel = this.deviceDataModel.device.controls.filter((control) => control.tag == tag)[0]\n\t\t\tif (controlModel) {\n\t\t\t\treturn controlModel\n\t\t\t}\n\t\t\treturn null\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./device-dimmer-setting.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./device-dimmer-setting.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1591085424336\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1591085550885\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}