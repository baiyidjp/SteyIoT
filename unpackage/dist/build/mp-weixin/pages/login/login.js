(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"666e":function(t,e,n){"use strict";n.r(e);var o=n("d899"),i=n("71f0");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("980b");var a,r=n("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=c.exports},"71f0":function(t,e,n){"use strict";n.r(e);var o=n("e9e8"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},"980b":function(t,e,n){"use strict";var o=n("f88f"),i=n.n(o);i.a},c680:function(t,e,n){"use strict";(function(t){n("9155");o(n("66fd"));var e=o(n("666e"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},d899:function(t,e,n){"use strict";var o,i=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}))},e9e8:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("2f62");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r={data:function(){return{nationCode:"86",mobile:"",password:"",verificationCode:"",codeButtonText:"发送",timer:null,seconds:60,isTimeDown:!1,isLoginByPassword:!0,codeButtonDisabled:!0,loginButtonDisabled:!0,changeLoginText:"验证码登录"}},methods:s({},(0,o.mapMutations)(["login"]),{changeLoginClick:function(){this.isLoginByPassword=!this.isLoginByPassword,this.changeLoginText=this.isLoginByPassword?"验证码登录":"密码登录"},nationCodeClick:function(){t.showToast({icon:"none",title:"当前只支持中国手机号",duration:2e3})},mobileInput:function(t){var e=this;setTimeout((function(){var n=t.detail.value;e.mobile=n,"86"==e.nationCode?11==n.length?e.codeButtonDisabled=!1:e.codeButtonDisabled=!0:n.length>=4&&n.length<=15?e.codeButtonDisabled=!1:e.codeButtonDisabled=!0,e.loginButtonAbled()}),0)},passwordInput:function(t){var e=this;setTimeout((function(){e.password=t.detail.value,e.loginButtonAbled()}),0)},verificationCodeInput:function(t){var e=this;setTimeout((function(){e.verificationCode=t.detail.value,e.loginButtonAbled()}),0)},loginButtonAbled:function(){this.isLoginByPassword?this.password.length>=6&&this.password.length<=18&&!this.codeButtonDisabled?this.loginButtonDisabled=!1:this.loginButtonDisabled=!0:4!=this.verificationCode.length||this.codeButtonDisabled?this.loginButtonDisabled=!0:this.loginButtonDisabled=!1},codeButtonClick:function(){var e=this;if(!this.isTimeDown&&!this.codeButtonDisabled){t.showLoading({title:"",mask:!0});var n={mobile:this.mobile,nationCode:this.nationCode,typeC:"login"};t.request({url:"https://gateway.stey.com/stey-service/security/v2/vercode",method:"POST",data:{data:n,timestamp:Date.now()},header:{"Content-Type":"application/json; charset=utf-8"},responseType:"",success:function(n){if(200==n.statusCode)e.isTimeDown=!0,e.countDown(),e.timer=setInterval((function(){if(e.seconds--,e.seconds<=0)return clearInterval(e.timer),e.isTimeDown=!1,void(e.codeButtonText="发送");e.countDown()}),1e3);else{var o=n.data.error;o&&t.showToast({icon:"none",title:o,duration:2e3})}},fail:function(){},complete:function(){t.hideLoading()}})}},countDown:function(){this.codeButtonText=this.seconds+" s"},loginButtonClick:function(){var e=this;t.showLoading({title:"",mask:!0});var n=this.isLoginByPassword?"mobile":"token",o=this.isLoginByPassword?this.password:this.verificationCode,i={providerKey:"".concat(this.nationCode,"-").concat(this.mobile),providerId:n,passwordOrToken:o,accessPortal:"mobile_app"};t.request({url:"https://gateway.stey.com/auth-service/auth/login",method:"POST",data:{data:i,timestamp:Date.now()},header:{"Content-Type":"application/json; charset=utf-8"},responseType:"",success:function(n){if(console.log(n),200==n.statusCode){var o=n.data.data.accessToken;t.setStorageSync("token",o),t.setStorageSync("haveLogin",!0),e.login(),t.showToast({title:"登录成功",duration:2e3}),t.navigateBack()}else{var i=n.data.error;i&&t.showToast({icon:"none",title:i,duration:2e3})}},fail:function(){},complete:function(){t.hideLoading()}})}}),beforeDestroy:function(){clearInterval(this.timer)}};e.default=r}).call(this,n("543d")["default"])},f88f:function(t,e,n){}},[["c680","common/runtime","common/vendor"]]]);